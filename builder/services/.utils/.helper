#!/bin/bash
set -e
BACKEND_PATH=$(realpath $(dirname "$0")/)

function error_exit() {
  echo "<E>$1" >&2
  exit 1
}

function getDockerContainerId {
  if [[ -z ${1} ]]; then
    error_exit "[SERVICE_NAME]: argument missing"
  fi
  if [[ -z ${2} ]]; then
    error_exit "{CONTAINER}: argument missing"
  fi
  local ID=$(docker ps | grep "${1}-${2}" | awk '{print $1}')
  if [[ -z ${ID} ]]; then
    error_exit "docker container ${1}-${2} does not exists" >&2
    exit 1
  fi
  echo "${ID}"
}

function getDockerComposeContainerId {
  if [[ -z ${1} ]]; then
    error_exit "[SERVICE_NAME]: argument missing"
  fi
  if [[ -z ${2} ]]; then
    error_exit "{CONTAINER}: argument missing"
  fi
  local ID=$(docker-compose -f ${1}/docker-compose.yml ps | grep "${1}-${2}-" | awk '{print $1}')
  if [[ -z ${ID} ]]; then
    error_exit "docker-compose container ${1}-${2} does not exists" >&2
    exit 1
  fi
  echo "${ID}"
}